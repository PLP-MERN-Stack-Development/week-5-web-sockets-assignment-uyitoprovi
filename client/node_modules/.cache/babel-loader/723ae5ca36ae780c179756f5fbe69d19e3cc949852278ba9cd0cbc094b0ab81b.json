{"ast":null,"code":"var _import$meta,\n  _import$meta$env,\n  _s = $RefreshSig$();\n// client/src/socket/socket.js\nimport { io } from 'socket.io-client';\nimport { useEffect, useState } from 'react';\nconst SOCKET_URL = ((_import$meta = import.meta) === null || _import$meta === void 0 ? void 0 : (_import$meta$env = _import$meta.env) === null || _import$meta$env === void 0 ? void 0 : _import$meta$env.VITE_SOCKET_URL) || 'http://localhost:5000';\nexport const socket = io(SOCKET_URL, {\n  autoConnect: false,\n  reconnection: true,\n  reconnectionAttempts: 5,\n  reconnectionDelay: 1000\n});\nexport const useSocket = () => {\n  _s();\n  const [isConnected, setIsConnected] = useState(socket.connected);\n  const [lastMessage, setLastMessage] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [typingUsers, setTypingUsers] = useState([]);\n  const connect = username => {\n    socket.connect();\n    socket.emit('user_join', username);\n  };\n  const disconnect = () => socket.disconnect();\n  const sendMessage = message => {\n    socket.emit('send_message', {\n      message\n    });\n  };\n  const sendPrivateMessage = (to, message) => {\n    socket.emit('private_message', {\n      to,\n      message\n    });\n  };\n  const setTyping = isTyping => {\n    socket.emit('typing', isTyping);\n  };\n  useEffect(() => {\n    socket.on('connect', () => setIsConnected(true));\n    socket.on('disconnect', () => setIsConnected(false));\n    socket.on('receive_message', msg => {\n      setLastMessage(msg);\n      setMessages(prev => [...prev, msg]);\n    });\n    socket.on('private_message', msg => {\n      setMessages(prev => [...prev, msg]);\n    });\n    socket.on('user_list', setUsers);\n    socket.on('user_joined', user => {\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        system: true,\n        message: `${user.username} joined the chat`,\n        timestamp: new Date().toISOString()\n      }]);\n    });\n    socket.on('user_left', user => {\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        system: true,\n        message: `${user.username} left the chat`,\n        timestamp: new Date().toISOString()\n      }]);\n    });\n    socket.on('typing_users', setTypingUsers);\n    return () => socket.removeAllListeners();\n  }, []);\n  return {\n    socket,\n    isConnected,\n    lastMessage,\n    messages,\n    users,\n    typingUsers,\n    connect,\n    disconnect,\n    sendMessage,\n    sendPrivateMessage,\n    setTyping\n  };\n};\n_s(useSocket, \"OEwGX6C2wHqEG80JxEfeRPrH+Fo=\");","map":{"version":3,"names":["io","useEffect","useState","SOCKET_URL","_import$meta","import","meta","_import$meta$env","env","VITE_SOCKET_URL","socket","autoConnect","reconnection","reconnectionAttempts","reconnectionDelay","useSocket","_s","isConnected","setIsConnected","connected","lastMessage","setLastMessage","messages","setMessages","users","setUsers","typingUsers","setTypingUsers","connect","username","emit","disconnect","sendMessage","message","sendPrivateMessage","to","setTyping","isTyping","on","msg","prev","user","id","Date","now","system","timestamp","toISOString","removeAllListeners"],"sources":["C:/Users/provi/OneDrive - K L University/Desktop/PLP MERN STACK/week-5-web-sockets-assignment-uyitoprovi/client/src/socket/socket.js"],"sourcesContent":["// client/src/socket/socket.js\nimport { io } from 'socket.io-client';\nimport { useEffect, useState } from 'react';\n\nconst SOCKET_URL = import.meta?.env?.VITE_SOCKET_URL || 'http://localhost:5000';\nexport const socket = io(SOCKET_URL, {\n  autoConnect: false,\n  reconnection: true,\n  reconnectionAttempts: 5,\n  reconnectionDelay: 1000,\n});\n\nexport const useSocket = () => {\n  const [isConnected, setIsConnected] = useState(socket.connected);\n  const [lastMessage, setLastMessage] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [typingUsers, setTypingUsers] = useState([]);\n\n  const connect = (username) => {\n    socket.connect();\n    socket.emit('user_join', username);\n  };\n\n  const disconnect = () => socket.disconnect();\n\n  const sendMessage = (message) => {\n    socket.emit('send_message', { message });\n  };\n\n  const sendPrivateMessage = (to, message) => {\n    socket.emit('private_message', { to, message });\n  };\n\n  const setTyping = (isTyping) => {\n    socket.emit('typing', isTyping);\n  };\n\n  useEffect(() => {\n    socket.on('connect', () => setIsConnected(true));\n    socket.on('disconnect', () => setIsConnected(false));\n\n    socket.on('receive_message', (msg) => {\n      setLastMessage(msg);\n      setMessages((prev) => [...prev, msg]);\n    });\n\n    socket.on('private_message', (msg) => {\n      setMessages((prev) => [...prev, msg]);\n    });\n\n    socket.on('user_list', setUsers);\n    socket.on('user_joined', (user) => {\n      setMessages((prev) => [...prev, {\n        id: Date.now(),\n        system: true,\n        message: `${user.username} joined the chat`,\n        timestamp: new Date().toISOString()\n      }]);\n    });\n\n    socket.on('user_left', (user) => {\n      setMessages((prev) => [...prev, {\n        id: Date.now(),\n        system: true,\n        message: `${user.username} left the chat`,\n        timestamp: new Date().toISOString()\n      }]);\n    });\n\n    socket.on('typing_users', setTypingUsers);\n\n    return () => socket.removeAllListeners();\n  }, []);\n\n  return {\n    socket,\n    isConnected,\n    lastMessage,\n    messages,\n    users,\n    typingUsers,\n    connect,\n    disconnect,\n    sendMessage,\n    sendPrivateMessage,\n    setTyping,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}